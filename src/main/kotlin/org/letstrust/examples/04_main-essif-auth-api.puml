@startuml
'https://plantuml.com/sequence-diagram

skinparam classFontColor 007BFF
skinparam classFontSize 12
skinparam classFontName Aapex
skinparam backgroundColor white
skinparam minClassWidth 155
skinparam nodesep 34
skinparam ranksep 70

skinparam sequence {
ArrowColor 007BFF
ActorBorderColor 007BFF
LifeLineBorderColor 007BFF
LifeLineBackgroundColor 007BFF

ParticipantBorderColor 007BFF
ParticipantBackgroundColor 007BFF
ParticipantFontName Impact
ParticipantFontSize 17
ParticipantFontColor #A9DCDF

'ActorBackgroundColor aqua
ActorFontColor 007BFF
ActorFontSize 17
ActorFontName Aapex
}

skinparam class {
BorderColor 007BFF
ArrowColor 007BFF
BackgroundColor white
}

skinparam interface {
BorderColor 007BFF
ArrowColor 007BFF
}

skinparam note {
BorderColor 007BFF
BackgroundColor 7ACFF5
}


autonumber

header Authorization API
title
Gain access to EBSI resources by presenting a Verifiable Authorization
end title
autonumber
actor "Natural Person" as NP
participant "User Wallet\n(from NP)" as UW
participant "Authorisation API" as AA

NP -> UW: Trigger authentication flow
activate UW
UW -> AA: Request Access Token
AA -> AA: Create <Authentication Request>
AA --> UW: 200 <Authentication Request>
UW -> UW: Verify <Authentication Request>
UW -> UW: Create <Authentication Response>
UW -> AA: POST SiopSessionsRequest <Authentication Response>
AA -> AA: Verify <Authentication Response>
AA -> AA: Create & encrypt <Access Token>
AA -> UW: 200 <Access Token>
UW --> UW: Verify & decrypt <Access Token>
UW --> NP: Successful process
destroy UW
hnote across:By use of the Access Token the user-app can access protected EBSI resources (e.g. updateDID, revoke VC)
@enduml
